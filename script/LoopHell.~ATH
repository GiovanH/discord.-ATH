// WoC's card parser, in ~ATH form
~ATH(THIS){
	input CARDSTR "Enter the shorthand string for your card, ex. 5H, 10S, QD: ";
	ENUMERATE CARDSTR CARD;
	REPLICATE TEMP CARD;
	PROCREATE CARDLEN 0;
	PROCREATE SUIT;
	~ATH(TEMP){
		BIFURCATE TEMP[LVAL, TEMP];
		PROCREATE CARDLEN CARDLEN + 1;
		PROCREATE SUIT LVAL;
	}EXECUTE(NULL);
	BIFURCATE CARD[FACE, NULL];
	REPLICATE VALID CARDLEN < 2 l| CARDLEN > 3;
	~ATH(VALID){
		print("That doesn't even LOOK like a card string!\n");
		THIS.DIE();
	}EXECUTE(NULL);
	PROCREATE FACENAME "";
	REPLICATE FACECHECK CARDLEN == 3;
	~ATH(FACECHECK){
		PROCREATE FACENAME "Ten";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "2";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Two";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "3";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Three";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "4";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Four";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "5";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Five";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "6";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Six";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "7";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Seven";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "8";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Eight";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "9";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Nine";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "J";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Jack";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "Q";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Queen";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "K";
	~ATH(FACECHECK){
		PROCREATE FACENAME "King";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACE == "A";
	~ATH(FACECHECK){
		PROCREATE FACENAME "Ace";
		FACECHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE FACECHECK FACENAME == "";
	~ATH(FACECHECK){
		PROCREATE FACENAME "WRONG";
		print("This isn't a real card face!\n");
		FACECHECK.DIE();
	}EXECUTE(NULL);
	PROCREATE SUITNAME "";
	REPLICATE SUITCHECK SUIT == "S";
	~ATH(SUITCHECK){
		PROCREATE SUITNAME "Spades";
		SUITCHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE SUITCHECK SUIT == "H";
	~ATH(SUITCHECK){
		PROCREATE SUITNAME "Hearts";
		SUITCHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE SUITCHECK SUIT == "D";
	~ATH(SUITCHECK){
		PROCREATE SUITNAME "Diamonds";
		SUITCHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE SUITCHECK SUIT == "C";
	~ATH(SUITCHECK){
		PROCREATE SUITNAME "Clubs";
		SUITCHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE SUITCHECK SUITNAME == "";
	~ATH(SUITCHECK){
		PROCREATE SUITNAME "WRONG";
		print("This isn't a real card suit!\n");
		SUITCHECK.DIE();
	}EXECUTE(NULL);
	REPLICATE VALID SUITNAME ~= "WRONG" l& FACENAME ~= "WRONG";
	~ATH(VALID){
		print("Your card is the ~s of ~s.\n", FACENAME, SUITNAME);
		THIS.DIE();
	}EXECUTE(NULL);
	print("Go back and try again with a REAL deck of cards!\n");
	THIS.DIE();
}EXECUTE(NULL);
